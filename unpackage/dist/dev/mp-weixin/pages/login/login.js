(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/login/login"],{183:function(e,n,t){"use strict";(function(e,n){var o=t(4);t(26);o(t(25));var r=o(t(184));e.__webpack_require_UNI_MP_PLUGIN__=t,n(r.default)}).call(this,t(1)["default"],t(2)["createPage"])},184:function(e,n,t){"use strict";t.r(n);var o=t(185),r=t(187);for(var i in r)["default"].indexOf(i)<0&&function(e){t.d(n,e,(function(){return r[e]}))}(i);t(189);var u,c=t(32),a=Object(c["default"])(r["default"],o["render"],o["staticRenderFns"],!1,null,"b237504c",null,!1,o["components"],u);a.options.__file="pages/login/login.vue",n["default"]=a.exports},185:function(e,n,t){"use strict";t.r(n);var o=t(186);t.d(n,"render",(function(){return o["render"]})),t.d(n,"staticRenderFns",(function(){return o["staticRenderFns"]})),t.d(n,"recyclableRender",(function(){return o["recyclableRender"]})),t.d(n,"components",(function(){return o["components"]}))},186:function(e,n,t){"use strict";var o;t.r(n),t.d(n,"render",(function(){return r})),t.d(n,"staticRenderFns",(function(){return u})),t.d(n,"recyclableRender",(function(){return i})),t.d(n,"components",(function(){return o}));try{o={uButton:function(){return Promise.all([t.e("common/vendor"),t.e("node-modules/uview-ui/components/u-button/u-button")]).then(t.bind(null,339))},uDivider:function(){return Promise.all([t.e("common/vendor"),t.e("node-modules/uview-ui/components/u-divider/u-divider")]).then(t.bind(null,349))}}}catch(c){if(-1===c.message.indexOf("Cannot find module")||-1===c.message.indexOf(".vue"))throw c;console.error(c.message),console.error("1. 排查组件名称拼写是否正确"),console.error("2. 排查组件是否符合 easycom 规范，文档：https://uniapp.dcloud.net.cn/collocation/pages?id=easycom"),console.error("3. 若组件不符合 easycom 规范，需手动引入，并在 components 中注册该组件")}var r=function(){var e=this,n=e.$createElement;e._self._c},i=!1,u=[];r._withStripped=!0},187:function(e,n,t){"use strict";t.r(n);var o=t(188),r=t.n(o);for(var i in o)["default"].indexOf(i)<0&&function(e){t.d(n,e,(function(){return o[e]}))}(i);n["default"]=r.a},188:function(e,n,t){"use strict";(function(e,o){var r=t(4);Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var i=r(t(56)),u=r(t(58)),c=t(170),a={data:function(){return{app:null,phone:"",code:"",codeState:!1,seconds:60,timer:null}},onLoad:function(){this.app=getApp()},methods:{toWechatLogin:function(){e.navigateTo({url:"/pages/wechatLogin/wechatLogin"})},validatePhoneNumber:function(e){if(!e)return"empty";var n=/^1[3456789]\d{9}$/;return n.test(e)?"ok":"no"},getCode:function(){var n=this;return(0,u.default)(i.default.mark((function t(){var o,r,u;return i.default.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(!n.codeState){t.next=2;break}return t.abrupt("return",!1);case 2:if(n.timer&&clearInterval(n.timer),o=n.validatePhoneNumber(n.phone),"ok"==o){t.next=7;break}return e.showToast({icon:"none",title:"no"==o?"手机号格式错误":"请输入手机号"}),t.abrupt("return",!1);case 7:return t.next=9,n.getPhoneCode();case 9:r=t.sent,e.showToast({icon:"none",title:r}),"验证码已发送"==r&&(n.codeState=!0,u=setInterval((function(){n.seconds=n.seconds-1,0==n.seconds&&(n.codeState=!1,n.seconds=60,clearInterval(n.timer))}),1e3),n.timer=u);case 12:case"end":return t.stop()}}),t)})))()},getPhoneCode:function(){var e=this;return new Promise((function(n,t){(0,c.request)({url:"common/get-phone-code",method:"POST",data:{phone:e.phone}}).then((function(e){200==e.code?n("验证码已发送"):500==e.code&&"刚发的验证码，5分钟有效"==e.msg&&n("不可重复获取验证码")}))}))},toLogin:function(){var n=this,t=this.validatePhoneNumber(this.phone);return"ok"!=t?(e.showToast({icon:"none",title:"no"==t?"手机号格式错误":"请输入手机号"}),!1):this.code?6!=this.code.length?(e.showToast({icon:"none",title:"验证码长度为6位"}),!1):void(0,c.request)({url:"common/phone-code-login",method:"POST",data:{phone:this.phone,code:this.code}}).then(function(){var t=(0,u.default)(i.default.mark((function t(r){var u;return i.default.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(200!=r.code){t.next=8;break}return n.app.globalData.userInfo.ouid=r.data.ouid,t.next=4,n.app.getUserInfo();case 4:u=t.sent,e.showToast({icon:"none",title:"登录成功",success:function(){u.wx_openid||o.login({success:function(e){e.code&&(0,c.request)({url:"wx/get/wx/id",method:"POST",data:{code:e.code,user_ouid:r.data.ouid,type:"A"}}).then((function(){}))}}),setTimeout((function(){e.redirectTo({url:"/pages/index/index"})}),1e3)}}),t.next=9;break;case 8:500==r.code&&e.showToast({icon:"none",title:r.msg});case 9:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()):(e.showToast({icon:"none",title:"验证码不能为空"}),!1)},toArrgement:function(){e.navigateTo({url:"/pages/arrgement/arrgement"})}}};n.default=a}).call(this,t(2)["default"],t(1)["default"])},189:function(e,n,t){"use strict";t.r(n);var o=t(190),r=t.n(o);for(var i in o)["default"].indexOf(i)<0&&function(e){t.d(n,e,(function(){return o[e]}))}(i);n["default"]=r.a},190:function(e,n,t){}},[[183,"common/runtime","common/vendor"]]]);
//# sourceMappingURL=../../../.sourcemap/mp-weixin/pages/login/login.js.map